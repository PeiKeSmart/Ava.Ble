<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Ava.Ble.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
        x:Class="Ava.Ble.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Icon="/Assets/avalonia-logo.ico"
        Title="Ava.Ble">

    <Design.DataContext>
        <!-- This only sets the DataContext for the previewer in an IDE,
             to set the actual DataContext for runtime, set the DataContext property in code (look at App.axaml.cs) -->
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <Grid RowDefinitions="Auto,*,Auto" Margin="10">
        <StackPanel Grid.Row="0" Orientation="Horizontal" Spacing="10" Margin="0,0,0,10">
            <Button Command="{Binding StartScanCommand}" IsEnabled="{Binding !IsScanning}" Content="开始扫描" />
            <Button Command="{Binding StopScanCommand}" IsEnabled="{Binding IsScanning}" Content="停止扫描" />
            <TextBlock Text="{Binding StatusMessage}" VerticalAlignment="Center" />
        </StackPanel>

        <DataGrid Grid.Row="1"
                  Items="{Binding DiscoveredDevices}"
                  SelectedItem="{Binding SelectedDevice}"
                  AutoGenerateColumns="False"
                  IsReadOnly="True"
                  GridLinesVisibility="All"
                  BorderThickness="1"
                  Margin="0,0,0,10">
            <DataGrid.Columns>
                <DataGridTextColumn Header="设备名称" Binding="{Binding Name}" Width="*" />
                <DataGridTextColumn Header="设备ID" Binding="{Binding Id}" Width="*" />
                <DataGridTextColumn Header="信号强度" Binding="{Binding SignalStrength}" Width="100" />
                <DataGridTextColumn Header="最后发现时间" Binding="{Binding LastSeenTime}" Width="120" />
                <DataGridCheckBoxColumn Header="可连接" Binding="{Binding IsConnectable}" Width="80" />
            </DataGrid.Columns>
        </DataGrid>

        <StackPanel Grid.Row="2" Orientation="Vertical" Spacing="5">
            <TextBlock Text="设备详情:" FontWeight="Bold" />
            <StackPanel IsVisible="{Binding SelectedDevice, Converter={x:Static ObjectConverters.IsNotNull}}">
                <TextBlock Text="{Binding SelectedDevice.DisplayName}" />
                <TextBlock Text="{Binding SelectedDevice.SignalStrength, StringFormat='信号强度: {0}'}" />
                <TextBlock Text="{Binding SelectedDevice.LastSeenTime, StringFormat='最后发现时间: {0}'}" />
                <TextBlock Text="{Binding SelectedDevice.ServiceCount, StringFormat='服务数量: {0}'}" />
            </StackPanel>
        </StackPanel>
    </Grid>

</Window>
